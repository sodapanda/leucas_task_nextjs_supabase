(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[802],{1311:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/story",function(){return a(8758)}])},8758:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var n=a(5893),o=a(7294),i=a(4053),r=a(4523),s=a(61),c=a(5117),l=a(4777),u=a(1232),d=a(7841),m=a(8495),f=a(917),h=a(6817);let p=(0,f.F4)({"from, to":{opacity:.4},"50%":{opacity:1}});var w=(0,h.k)((e,{height:t,width:a,radius:n,circle:o,animate:i})=>({root:{height:t,width:o?t:a,borderRadius:o?t:e.fn.radius(n),position:"relative",overflow:"hidden",WebkitTransform:"translateZ(0)"},visible:{"&::before":{content:'""',position:"absolute",background:"dark"===e.colorScheme?e.colors.dark[7]:e.white,top:0,bottom:0,left:0,right:0,zIndex:10},"&::after":{content:'""',position:"absolute",background:"dark"===e.colorScheme?e.colors.dark[4]:e.colors.gray[3],top:0,bottom:0,left:0,right:0,animation:i?`${p} 1500ms linear infinite`:"none",zIndex:11}}})),x=Object.defineProperty,b=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,y=(e,t,a)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,v=(e,t)=>{for(var a in t||(t={}))g.call(t,a)&&y(e,a,t[a]);if(b)for(var a of b(t))k.call(t,a)&&y(e,a,t[a]);return e},_=(e,t)=>{var a={};for(var n in e)g.call(e,n)&&0>t.indexOf(n)&&(a[n]=e[n]);if(null!=e&&b)for(var n of b(e))0>t.indexOf(n)&&k.call(e,n)&&(a[n]=e[n]);return a};let j={height:"auto",width:"100%",visible:!0,animate:!0},S=(0,o.forwardRef)((e,t)=>{let a=(0,m.N4)("Skeleton",j,e),{height:n,width:i,visible:s,animate:c,className:l,circle:u,radius:d,unstyled:f}=a,h=_(a,["height","width","visible","animate","className","circle","radius","unstyled"]),{classes:p,cx:x}=w({height:n,width:i,circle:u,radius:d,animate:c},{unstyled:f,name:"Skeleton"});return o.createElement(r.x,v({className:x(p.root,{[p.visible]:s},l),ref:t},h))});function O(){(0,i.useUser)();let e=(0,i.useSupabaseClient)(),[t,a]=(0,o.useState)({}),[m,f]=(0,o.useState)({}),[h,p]=(0,o.useState)(""),[w,x]=(0,o.useState)(""),[b,g]=(0,o.useState)(!1),[k,y]=(0,o.useState)("");async function v(t){let{data:n,error:o}=await e.from("tasks").select("*").eq("id",t);if(o){alert(o.message);return}console.log(n),a(n[0]),_(n[0].idea_id)}async function _(t){let{data:a,error:n}=await e.from("idea_view").select("*").eq("id",t);if(console.log(a),n){alert(n.message);return}f(a[0])}async function j(e,t){g(!0);let a=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(k)},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:e}]})}),n=await a.json(),o=n.choices[0].message.content;t(o),g(!1)}return(0,o.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("taskid");v(t)},[]),(0,o.useEffect)(()=>{p("".concat(m.role_name," ").concat(m.trouble_name,".因为").concat(m.superpower_name,",所以可以").concat(m.new_insight,",从而").concat(m.idea_name,".我适合做这个产品因为").concat(m.advantage,".产品推广关键词如下:").concat(m.keyword))},[m]),(0,n.jsxs)(r.x,{component:"div",className:"w-full",px:"xs",children:[(0,n.jsx)(s.o,{label:"api Key",placeholder:"sk-xxx",value:k,onChange:e=>{y(e.target.value)}}),(0,n.jsx)(c.x,{children:h}),(0,n.jsx)(l.i,{my:"sm",variant:"dashed"}),(0,n.jsx)(c.x,{children:t.features}),(0,n.jsx)(l.i,{my:"sm",variant:"dashed"}),(0,n.jsxs)(u.Z,{position:"right",children:[(0,n.jsx)(d.z,{variant:"outline",onClick:async()=>{await j("产品名字叫做".concat(t.task_name,"\n 产品定位").concat(h," \n 产品功能 ").concat(t.features," \n 请生成推广Tweet \n要求包含emoji,包含产品关键功能,不要太浮夸,用中文输出:"),e=>{x(e)})},children:"生成推广tweet"}),(0,n.jsx)(d.z,{variant:"outline",onClick:async()=>{await j("产品名字叫做".concat(t.task_name,"\n 产品定位").concat(h," \n 产品功能 ").concat(t.features," \n请生成推广视频分镜"),e=>{x(e)})},children:"生成分镜"}),(0,n.jsx)(d.z,{variant:"outline",onClick:async()=>{await j("要求使用中文回答。产品名字叫做".concat(t.task_name,"\n 产品定位").concat(h," \n 产品功能 ").concat(t.features," \n 请以推广").concat(t.task_name,"为目的生成一个故事。"),e=>{x(e)})},children:"生成故事"})]}),b?(0,n.jsxs)(r.x,{mt:"sm",component:"div",children:[(0,n.jsx)(S,{height:8,radius:"xl"}),(0,n.jsx)(S,{height:8,mt:6,radius:"xl"}),(0,n.jsx)(S,{height:8,mt:6,width:"70%",radius:"xl"})]}):(0,n.jsx)(c.x,{mt:"sm",children:w})]})}S.displayName="@mantine/core/Skeleton"}},function(e){e.O(0,[967,774,888,179],function(){return e(e.s=1311)}),_N_E=e.O()}]);